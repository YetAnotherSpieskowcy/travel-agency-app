services:
  proxy:
    image: ghcr.io/yetanotherspieskowcy/rsww_184529_proxy
    ports:
      - "8080:80"
    build: 
      context: ./proxy
      additional_contexts:
        - static=./static
  broker:
    image: ghcr.io/yetanotherspieskowcy/rsww_184529_broker
    build:
      context: ./broker
  api-gateway:
    image: ghcr.io/yetanotherspieskowcy/rsww_184529_api_gateway
    build:
      context: ./api_gateway
    env_file:
      - ./default.env
  tour-operator:
    image: ghcr.io/yetanotherspieskowcy/rsww_184529_tour_operator
    build:
        context: ./tour_operator
  trip-reservations:
    image: ghcr.io/yetanotherspieskowcy/rsww_184529_trip_reservations
    build:
        context: ./trip_reservations
  price-calculator:
    image: ghcr.io/yetanotherspieskowcy/rsww_184529_price_calculator
    build:
      context: ./price_calculator
    depends_on:
      broker:
        condition: service_healthy
